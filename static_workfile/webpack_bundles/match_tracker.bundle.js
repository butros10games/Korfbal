(()=>{"use strict";function e(e,n){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,n){if(e){if("string"==typeof e)return t(e,n);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?t(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){a&&(e=a);var r=0,l=function(){};return{s:l,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,d=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return i=e.done,e},e:function(e){d=!0,o=e},f:function(){try{i||null==a.return||a.return()}finally{if(d)throw o}}}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var n,a,r,l,o,i,d,s,c=/([a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12})/g,p=window.location.href,m=null;function y(e){var t=document.getElementById("home"===e?"Aanval":"Verdediging").getElementsByClassName("player-selector");Array.from(t).forEach((function(t){t.style.background="",t.removeEventListener("click",t._playerClickHandler),delete t._playerClickHandler;var a=function(){var a={command:"shot_reg",player_id:t.id,time:(new Date).toISOString(),for_team:"home"===e};console.log(a),n.send(JSON.stringify(a))};t._playerClickHandler=a,t.addEventListener("click",a)}))}function u(e){n&&(n.onclose=null,n.close()),(n=new WebSocket(e)).onopen=function(e){console.log("Connection established!"),n.send(JSON.stringify({command:"playerGroups"})),n.send(JSON.stringify({command:"last_event"})),n.send(JSON.stringify({command:"get_time"}))},n.onmessage=v,n.onclose=function(t){t.wasClean?console.log("Connection closed cleanly, code=".concat(t.code,", reason=").concat(t.reason)):console.error("Connection died"),console.log("Attempting to reconnect..."),setTimeout((function(){return u(e)}),3e3)}}function v(t){var a=JSON.parse(t.data),r=document.getElementById("start-stop-button");if(a.error)!function(e){if("match is paused"===e.error){var t=document.createElement("div");t.id="overlay",t.classList.add("overlay");var n=f("De wedstrijd is gepauzeerd."),a=n[0],r=n[1];r.addEventListener("click",(function(){t.remove(),document.body.style.overflow=""})),a.appendChild(r),t.appendChild(a),document.body.appendChild(t),document.body.style.overflow="hidden"}}(a);else switch(a.command){case"last_event":!function(e){var t;g(o),(t=document.getElementById("match-event")).style.transform="translateX(0px)",t.classList.remove("transition-back"),t.classList.remove("swiped-left"),function(e){var t=e.last_event,n=document.createElement("div");switch(n.style.display="flex",n.style.justifyContent="space-between",n.style.width="100%",n.style.height="100%",t.type){case"goal":var a=createEventTypeDiv(t.type,"64px",t.for_team?"#4CAF50":"rgba(235, 0, 0, 0.7)"),r=createMidsectionDiv(t.shot_type+' ("'+t.time+'")',truncateMiddle(t.player,20)),l=createScoreDiv(t.goals_for+"-"+t.goals_against,"84px");n.appendChild(a),n.appendChild(r),n.appendChild(l);break;case"wissel":var o=createEventTypeDiv(t.type,"64px","#eb9834"),i=createMidsectionDiv('("'+t.time+'")',truncateMiddle(t.player_in,15)+" --\x3e "+truncateMiddle(t.player_out,15)),d=document.createElement("div");d.style.width="84px",n.appendChild(o),n.appendChild(i),n.appendChild(d);break;case"pause":var s=createEventTypeDiv(t.type,"64px","#2196F3"),c=createMidsectionDiv('("'+t.time+'")',getFormattedTime(t)),p=document.createElement("div");p.style.width="84px",n.appendChild(s),n.appendChild(c),n.appendChild(p);break;case"shot":var m=createEventTypeDiv(t.type,"64px",t.for_team?"#43ff644d":"#eb00004d"),y=createMidsectionDiv('("'+t.time+'")',truncateMiddle(t.player,20)),u=document.createElement("div");u.style.width="84px",n.appendChild(m),n.appendChild(y),n.appendChild(u);break;case"no_event":var v=document.createElement("p");v.classList.add("flex-center"),v.style.margin="0",v.style.height="64px",v.innerHTML="Geen events gevonden.",v.style.width="100%",n.appendChild(v);break;default:console.warn("Unknown event type: ",t.type);var f=document.createElement("p");f.innerHTML="Onbekend event type: "+t.type,n.appendChild(f)}var g=document.getElementById("match-event");g?g.appendChild(n):console.error("Event container not found")}(e)}(a);break;case"playerGroups":!function(e){g(o),g(i),e.match_active?(function(e){var t=document.getElementById("home-score"),n=document.getElementById("away-score");t.classList.contains("activated")&&(t.classList.remove("activated"),t.style.background="#43ff6480"),n.classList.contains("activated")&&(n.classList.remove("activated"),n.style.background="rgba(235, 0, 0, 0.5)");var a=!1,r=e.playerGroups,l=document.createElement("div");if(l.classList.add("player-group-container"),r.length>0)r.forEach((function(e){var t=document.createElement("div");t.classList.add("player-group"),t.classList.add("flex-column"),t.style.marginTop="12px";var n=document.createElement("div");n.classList.add("flex-row"),n.classList.add("player-group-title"),n.style.marginBottom="6px",n.style.margin="0 12px 6px 12px",n.style.width="calc(100% - 24px)";var r=document.createElement("div");if(r.style.fontWeight="600",r.innerHTML=e.current_type,r.id=e.id,n.appendChild(r),!a){var o=document.createElement("div");o.innerHTML="Wissel",o.id="switch-button",o.classList.add("switch-button"),o.classList.add("flex-center"),o.style.width="96px",o.addEventListener("click",(function(){h()})),n.appendChild(o),a=!0}var i=document.createElement("div");i.classList.add("player-group-players"),i.classList.add("flex-row"),i.style.flexWrap="wrap",i.style.alignItems="stretch",i.id=e.current_type;for(var d=0;d<4;d++){var s=e.players[d],c=document.createElement("div");c.classList.add("player-selector","flex-center"),c.style.flexGrow="1",c.style.flexBasis="calc(50% - 44px)",c.style.padding="0 6px",c.style.textAlign="center";var p=document.createElement("p");p.style.margin="0",p.style.fontSize="16px";var m=document.createElement("div");m.classList.add("flex-column");var y=document.createElement("p");y.id="shots-for",y.style.margin="0",y.style.fontSize="16px",y.style.marginBottom="-10px";var u=document.createElement("p");u.id="shots-against",u.style.margin="0",u.style.fontSize="16px",u.style.marginTop="-10px";var v=document.createElement("p");v.style.margin="0",v.style.fontSize="16px",s?(c.id=s.id,c.style.justifyContent="space-between",p.innerHTML=truncateMiddle(s.name,16),y.innerHTML=s.shots_for,u.innerHTML=s.shots_against,v.innerHTML="-"):p.innerHTML="geen data",m.appendChild(y),m.appendChild(v),m.appendChild(u),c.appendChild(p),c.appendChild(m),i.appendChild(c)}t.appendChild(n),t.appendChild(i),l.appendChild(t)}));else{var o=document.createElement("p");o.classList.add("flex-center"),o.innerHTML="<p>Geen spelersgroepen gevonden.</p>",l.appendChild(o)}i.appendChild(l)}(e),y("home"),y("away")):updatePlayerGroups(e,i,n)}(a);break;case"player_shot_change":!function(t){var n,a=e(document.getElementsByClassName("player-group-players"));try{for(a.s();!(n=a.n()).done;){var r=n.value.querySelector('[id="'.concat(t.player_id,'"]'));if(r){var l=r.querySelector("#shots-for"),o=r.querySelector("#shots-against");l.innerHTML=t.shots_for,o.innerHTML=t.shots_against}}}catch(e){a.e(e)}finally{a.f()}}(a);break;case"goal_types":!function(t){var a=document.createElement("div");a.id="overlay",a.classList.add("overlay");var r=document.createElement("div");r.classList.add("popup");var l=document.createElement("div");l.classList.add("goal-types-container"),l.style.display="flex",l.style.flexWrap="wrap";var o=document.createElement("div");o.classList.add("flex-row"),o.style.marginBottom="12px";var i=document.createElement("p");i.innerHTML="Doelpunt type",i.style.margin="0",o.appendChild(i);var s=document.createElement("button");s.classList.add("close-button"),s.innerHTML="Close",s.addEventListener("click",(function(){a.remove()})),o.appendChild(s),l.appendChild(o);var c,p=e(t.goal_types);try{var m=function(){var e=c.value,t=document.createElement("div");t.classList.add("goal-type"),t.classList.add("flex-center"),t.style.flexGrow="1",t.style.flexBasis="calc(50% - 32px)",t.style.textAlign="center",t.style.margin="0 12px 6px 12px",t.style.width="calc(100% - 12px)",t.style.background=e.color;var a=document.createElement("p");a.classList.add("flex-center"),a.innerHTML=truncateMiddle(e.name,16),a.style.margin="0",a.style.fontSize="16px",a.style.background="var(--button-color)",a.style.color="var(--text-color)",a.style.padding="6px",a.style.borderRadius="4px",a.style.width="100%",a.style.height="42px",a.style.cursor="pointer",a.style.userSelect="none",t.addEventListener("click",(function(){var t={command:"goal_reg",goal_type:e.id,player_id:d.player_id,time:d.time,for_team:d.for_team};n.send(JSON.stringify(t))})),t.appendChild(a),l.appendChild(t)};for(p.s();!(c=p.n()).done;)m()}catch(e){p.e(e)}finally{p.f()}r.appendChild(l),a.appendChild(r),document.body.appendChild(a),document.body.style.overflow="hidden"}(a);break;case"timer_data":!function(e,t){m&&(m.destroy(),m=null),"active"===e.type?((m=new CountdownTimer(e.time,1e3*e.length,null,1e3*e.pause_length,!0)).start(),t.innerHTML="Pause"):"pause"===e.type?((m=new CountdownTimer(e.time,1e3*e.length,e.calc_to,1e3*e.pause_length,!0)).stop(),t.innerHTML="Start"):"start"===e.type&&((m=new CountdownTimer(e.time,1e3*e.length,null,0,!0)).start(),t.innerHTML="Pause")}(a,r);break;case"pause":!function(e,t){!0===e.pause?(m.stop(),console.log("Timer paused"),t.innerHTML="Start"):!1===e.pause&&(m.start(e.pause_time),console.log("Timer resumed"),t.innerHTML="Pause")}(a,r);break;case"team_goal_change":!function(e){!function(e){var t=document.getElementById("home-score").querySelector("p"),n=document.getElementById("away-score").querySelector("p");t.innerHTML=e.goals_for,n.innerHTML=e.goals_against}(e);var t=document.getElementById("overlay");t&&t.remove();var n=document.querySelector(".activated");n&&n.click()}(a);break;case"non_active_players":!function(t){var a=document.createElement("div");a.id="overlay",a.classList.add("overlay");var r=document.createElement("div");r.classList.add("popup");var l=document.createElement("div");l.classList.add("goal-types-container"),l.style.display="flex",l.style.flexWrap="wrap";var o=document.createElement("div");o.classList.add("flex-row"),o.style.marginBottom="12px";var i=document.createElement("p");i.innerHTML="Doelpunt type",i.style.margin="0",o.appendChild(i);var d=document.createElement("button");d.classList.add("close-button"),d.innerHTML="Close",d.addEventListener("click",(function(){a.remove()})),o.appendChild(d),l.appendChild(o);var c,p=e(t.players);try{var m=function(){var e=c.value,a=document.createElement("div");a.classList.add("goal-type"),a.classList.add("flex-center"),a.style.flexGrow="1",a.style.flexBasis="calc(50% - 32px)",a.style.textAlign="center",a.style.margin="0 12px 6px 12px",a.style.width="calc(100% - 12px)",a.style.background=e.color;var r=document.createElement("p");r.classList.add("flex-center"),r.innerHTML=truncateMiddle(e.name,16),r.style.margin="0",r.style.fontSize="16px",r.style.background="var(--button-color)",r.style.color="var(--text-color)",r.style.padding="6px",r.style.borderRadius="4px",r.style.width="100%",r.style.height="42px",r.style.cursor="pointer",r.style.userSelect="none",a.addEventListener("click",(function(){var a={command:"wissel_reg",new_player_id:e.id,old_player_id:s.player_id,time:s.time};console.log(a),n.send(JSON.stringify(t))})),a.appendChild(r),l.appendChild(a)};for(p.s();!(c=p.n()).done;)m()}catch(e){p.e(e)}finally{p.f()}r.appendChild(l),a.appendChild(r),document.body.appendChild(a),document.body.style.overflow="hidden"}(a);break;case"player_change":!function(e){var t=document.getElementById(e.player_out_id);t.id=e.player_in_id,t.querySelector("p").innerHTML=e.player_in;var n=t.querySelector("#shots-for"),a=t.querySelector("#shots-against");n.innerHTML=e.player_in_shots_for,a.innerHTML=e.player_in_shots_against,h(),document.getElementById("overlay").remove()}(a);break;case"part_end":!function(e,t){document.getElementById("periode_number").innerHTML=e.part,m.stop(),m=null;var n=document.getElementById("counter"),a=e.part_length/60,r=e.part_length%60;n.innerHTML=a+":"+r.toString().padStart(2,"0"),document.getElementById("end-half-button").style.display="none",t.innerHTML="start"}(a,r);break;case"match_end":!function(e,t){m&&(m.stop(),m=null),t.innerHTML="match ended";var n=document.createElement("div");n.id="overlay",n.classList.add("overlay");var a=f("De wedstrijd is afgelopen."),r=a[0],l=a[1];l.addEventListener("click",(function(){n.remove(),document.body.style.overflow="",window.location.href="/match/"+e.match_id+"/"})),r.appendChild(l),n.appendChild(r),document.body.appendChild(n),document.body.style.overflow="hidden"}(a,r)}}function f(e){var t=document.createElement("div");t.classList.add("popup");var n=document.createElement("p");n.innerHTML=e,n.style.margin="0",n.style.fontSize="20px",n.style.fontWeight="600",n.style.marginBottom="12px",t.appendChild(n);var a=document.createElement("button");return a.classList.add("button"),a.innerHTML="OK",a.style.margin="0",a.style.width="100%",a.style.height="42px",a.style.fontSize="16px",a.style.fontWeight="600",a.style.marginBottom="12px",a.style.background="var(--button-color)",a.style.color="var(--text-color)",a.style.border="none",a.style.borderRadius="4px",a.style.cursor="pointer",a.style.userSelect="none",[t,a]}function g(e){e.innerHTML="",e.classList.remove("flex-center"),e.classList.remove("flex-start-wrap")}function h(){var e=document.getElementById("switch-button");if(e.classList.contains("activated")){e.classList.remove("activated"),e.style.background="";var t=document.getElementsByClassName("player-selector");Array.from(t).forEach((function(e){e.style.background="",e._playerClickHandler&&(e.removeEventListener("click",e._playerClickHandler),delete e._playerClickHandler)})),y("home"),y("away")}else{e.classList.add("activated"),e.style.background="#4169e152";var a=document.getElementsByClassName("player-selector");Array.from(a).forEach((function(e){var t=document.getElementById("home-score"),a=document.getElementById("away-score");t.classList.contains("activated")&&(t.classList.remove("activated"),t.style.background="#43ff6480"),a.classList.contains("activated")&&(a.classList.remove("activated"),a.style.background="rgba(235, 0, 0, 0.5)"),e.style.background="#4169e152",e._playerClickHandler&&(e.removeEventListener("click",e._playerClickHandler),delete e._playerClickHandler);var r=function(){s={player_id:e.id,time:(new Date).toISOString()},n.send(JSON.stringify({command:"get_non_active_players"}))};e._playerClickHandler=r,e.addEventListener("click",r)}))}}window.addEventListener("DOMContentLoaded",(function(){o=document.getElementById("match-event"),i=document.getElementById("players");var t,s=p.match(c);console.log(s),s&&s.length>=2?(a=s[0],r=s[1],console.log("First UUID:",a),console.log("Second UUID:",r)):console.log("Not enough UUIDs found in the URL."),l="wss://"+window.location.host+"/ws/match/tracker/"+a+"/"+r+"/",(t=o).classList.add("flex-center"),t.innerHTML="<div id='load_icon' class='small-lds-ring'><div></div><div></div><div></div><div></div></div>",function(e){e.classList.add("flex-center"),e.innerHTML="<div id='load_icon' class='lds-ring'><div></div><div></div><div></div><div></div></div>"}(i),u(l),function(){var t,a=e(document.getElementsByClassName("button"));try{var r=function(){var e=t.value;e.addEventListener("click",(function(){var t={command:"event",event:e.id};n.send(JSON.stringify(t))}))};for(a.s();!(t=a.n()).done;)r()}catch(e){a.e(e)}finally{a.f()}document.getElementById("end-half-button").addEventListener("click",(function(){n.send(JSON.stringify({command:"part_end"}))}))}(),function(){var e=document.getElementById("home-score"),t=document.getElementById("away-score");function a(t,a){var i;t.classList.contains("activated")?(r(t,a),y(a)):((i=document.querySelector(".activated"))&&r(i,i===e?"home":"away"),function(e,t){var a=l(t);e.style.background=o(t,!0),e.classList.add("activated"),function(e,t){Array.from(e).forEach((function(e){e.style.background=o(t,!1),e._playerClickHandler&&(e.removeEventListener("click",e._playerClickHandler),delete e._playerClickHandler);var a=function(e,t){return function(){var a={command:"get_goal_types"};d={player_id:e.id,time:(new Date).toISOString(),for_team:"home"===t},n.send(JSON.stringify(a))}}(e,t);e._playerClickHandler=a,e.addEventListener("click",a)}))}(a,t)}(t,a))}function r(e,t){var n=l(t);e.style.background=o(t,!1),e.classList.remove("activated"),function(e){Array.from(e).forEach((function(e){e.style.background="",e._playerClickHandler&&(e.removeEventListener("click",e._playerClickHandler),delete e._playerClickHandler)}))}(n)}function l(e){var t="home"===e?"Aanval":"Verdediging";return document.getElementById(t).getElementsByClassName("player-selector")}function o(e,t){return"home"===e?t?"#43ff64":"#43ff6480":t?"rgba(235, 0, 0, 0.7)":"rgba(235, 0, 0, 0.5)"}e.addEventListener("click",(function(){return a(e,"home")})),t.addEventListener("click",(function(){return a(t,"away")}))}(),document.getElementById("start-stop-button").addEventListener("click",(function(){n.send(JSON.stringify({command:"start/pause"}))})),function(){var e=document.getElementById("match-event-swipe"),t=document.getElementById("match-event");t.style.transform="translateX(0px)";var n,a,r=!1;t.addEventListener("touchstart",(function(e){var a=window.getComputedStyle(t).getPropertyValue("transform").split(",")[4].trim();n=e.touches[0].clientX-parseInt(a),r=!0,t.classList.remove("transition-back")}),{passive:!0}),t.addEventListener("touchmove",(function(e){if(r){a=e.touches[0].clientX;var l=n-a;l>=0&&requestAnimationFrame((function(){t.style.transform="translateX(".concat(-Math.min(l,100),"px)")}))}}),{passive:!0}),t.addEventListener("touchend",(function(){r=!1;var l=n-a>50;t.style.transform=l?"translateX(-100px)":"translateX(0px)",t.classList.add("transition-back"),e.classList.toggle("swiped-left",l)}),!1)}(),document.getElementById("deleteButton").addEventListener("click",(function(){!function(){var e=document.createElement("div");e.id="overlay",e.classList.add("overlay");var t=document.createElement("div");t.classList.add("popup");var a=document.createElement("div");a.classList.add("flex-row"),a.style.marginBottom="24px";var r=document.createElement("p");r.innerHTML="Event verwijderen?",r.style.margin="0",r.style.fontSize="20px",r.style.fontWeight="600";var l=document.createElement("button");l.classList.add("close-button"),l.innerHTML="Close",l.addEventListener("click",(function(){e.remove()})),a.appendChild(r),a.appendChild(l),t.appendChild(a);var o=document.createElement("div");o.classList.add("flex-row"),o.style.justifyContent="space-between";var i=document.createElement("button");i.classList.add("button"),i.innerHTML="Ja",i.style.margin="0",i.style.width="calc(50% - 12px)",i.style.height="42px",i.style.fontSize="16px",i.style.fontWeight="600",i.style.background="var(--button-color)",i.style.color="var(--text-color)",i.style.border="none",i.style.borderRadius="4px",i.style.cursor="pointer",i.style.userSelect="none",i.addEventListener("click",(function(){e.remove(),document.body.style.overflow="";n.send(JSON.stringify({command:"remove_last_event"}))})),o.appendChild(i);var d=document.createElement("button");d.classList.add("button"),d.innerHTML="Nee",d.style.margin="0",d.style.width="calc(50% - 12px)",d.style.height="42px",d.style.fontSize="16px",d.style.fontWeight="600",d.style.background="red",d.style.color="var(--text-color)",d.style.border="none",d.style.borderRadius="4px",d.style.cursor="pointer",d.style.userSelect="none",d.addEventListener("click",(function(){e.remove(),document.body.style.overflow=""})),o.appendChild(d),t.appendChild(o),e.appendChild(t),document.body.appendChild(e),document.body.style.overflow="hidden",e.addEventListener("click",(function(){e.remove(),document.body.style.overflow=""})),t.addEventListener("click",(function(e){e.stopPropagation()}))}()}))}))})();